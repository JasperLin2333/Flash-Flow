# Tool èŠ‚ç‚¹ (å·¥å…·èŠ‚ç‚¹)

## åŠŸèƒ½æè¿°

è°ƒç”¨å¤–éƒ¨å·¥å…·æˆ–æ‰§è¡Œä»£ç æ¥å®Œæˆä¸“é¡¹ä»»åŠ¡ã€‚ä½œä¸ºè¿æ¥ AI ä¸å¤–éƒ¨ä¸–ç•Œçš„æ¡¥æ¢ï¼Œæ”¯æŒ**å‚æ•°è‡ªåŠ¨éªŒè¯**å’Œ**å˜é‡å¼•ç”¨**ã€‚

## æ ¸å¿ƒå‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | æè¿° |
|-------|------|-----|-------|------|
| `label` | string | âœ… | - | èŠ‚ç‚¹æ˜¾ç¤ºåç§° |
| `toolType` | string | âœ… | - | å·¥å…·ç±»å‹é€‰æ‹© (è§ä¸‹æ–‡) |
| `inputs` | object | âŒ | `{}` | å·¥å…·ç‰¹å®šçš„è¾“å…¥å‚æ•° (æ”¯æŒ `{{å˜é‡}}` å¼•ç”¨) |
| `customOutputs` | array | âŒ | `[]` | ç”¨æˆ·è‡ªå®šä¹‰è¾“å‡ºå˜é‡åˆ—è¡¨ `{name, value}` |

## æ”¯æŒçš„å·¥å…· (Supported Tools)

### 1. ğŸ” ç½‘é¡µæœç´¢ (Web Search)

ä½¿ç”¨ Tavily æœç´¢å¼•æ“è”ç½‘æŸ¥æ‰¾å®æ—¶ä¿¡æ¯ã€‚

*   **ID**: `web_search`
*   **è¾“å…¥å‚æ•°**:
    *   `query` (string, å¿…å¡«): æœç´¢å…³é”®è¯ã€‚
    *   `maxResults` (number, é€‰å¡«): æœ€å¤§ç»“æœæ•° (1-10, é»˜è®¤ 5)ã€‚
*   **è¾“å‡ºç¤ºä¾‹**:
    ```json
    {
      "results": [
        { "title": "...", "url": "...", "content": "..." }
      ],
      "count": 5
    }
    ```

### 2. ğŸ ä»£ç æ‰§è¡Œ (Code Interpreter)

åœ¨å®‰å…¨çš„ E2B æ²™ç®±ç¯å¢ƒä¸­æ‰§è¡Œ Python ä»£ç ã€‚æ”¯æŒæ–‡ä»¶å¤„ç†å’Œå›¾è¡¨ç”Ÿæˆã€‚

*   **ID**: `code_interpreter`
*   **è¾“å…¥å‚æ•°**:
    *   `code` (string, å¿…å¡«): Python ä»£ç å†…å®¹ã€‚
    *   `inputFiles` (array, é€‰å¡«): éœ€è¦ä¸Šä¼ åˆ°æ²™ç®±çš„æ–‡ä»¶åˆ—è¡¨ (`{name, url}`)ã€‚
    *   `outputFileName` (string, é€‰å¡«): æœŸæœ›ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶å (å¦‚ `output.csv`, `result.xlsx`)ã€‚
*   **è¾“å‡ºç¤ºä¾‹**:
    ```json
    {
      "logs": "æ ‡å‡†è¾“å‡ºæ—¥å¿—...",
      "errors": "",
      "result": "ä»£ç æœ€åä¸€è¡Œè¡¨è¾¾å¼çš„è¿”å›å€¼",
      "generatedFile": {
        "name": "plot.png",
        "url": "https://...",
        "type": "image/png"
      }
    }
    ```

### 3. ğŸ§® è®¡ç®—å™¨ (Calculator)

å®‰å…¨è®¡ç®—æ•°å­¦è¡¨è¾¾å¼ã€‚

*   **ID**: `calculator`
*   **è¾“å…¥å‚æ•°**:
    *   `expression` (string, å¿…å¡«): æ•°å­¦è¡¨è¾¾å¼ (å¦‚ `(10 * 5) + 2`)ã€‚
*   **è¾“å‡ºç¤ºä¾‹**:
    ```json
    {
      "expression": "(10 * 5) + 2",
      "result": 52
    }
    ```

### 4. ğŸ• æ—¥æœŸæ—¶é—´ (Datetime)

å¤„ç†æ—¶é—´è·å–ã€æ ¼å¼åŒ–åŠè®¡ç®—ã€‚

*   **ID**: `datetime`
*   **è¾“å…¥å‚æ•°**:
    *   `operation` (enum, é€‰å¡«): `now` (é»˜è®¤), `format`, `diff`, `add`ã€‚
    *   `format` (string, é€‰å¡«): è¾“å‡ºæ ¼å¼ (é»˜è®¤ `YYYY-MM-DD HH:mm:ss`)ã€‚
    *   `date` (string, é€‰å¡«): åŸºå‡†æ—¥æœŸ (ISO æ ¼å¼æˆ–å¸¸è§æ ¼å¼ï¼Œç•™ç©ºåˆ™ä½¿ç”¨å½“å‰æ—¶é—´)ã€‚
    *   `targetDate` (string, é€‰å¡«): ç›®æ ‡æ—¥æœŸ (ç”¨äºè®¡ç®—æ—¥æœŸå·®)ã€‚
    *   `amount` (number, é€‰å¡«): å¢å‡æ•°é‡ (ç”¨äºæ—¥æœŸåŠ å‡)ã€‚
    *   `unit` (enum, é€‰å¡«): æ—¶é—´å•ä½ (`year`, `month`, `day`, `hour`, `minute`, `second`)ã€‚
*   **è¾“å‡ºç¤ºä¾‹**:
    ```json
    {
      "operation": "now",
      "formatted": "2024-03-20 10:00:00",
      "timestamp": 1710900000000
    }
    ```

### 5. ğŸŒ ç½‘é¡µè¯»å– (URL Reader)

æå–å¹¶è§£æç›®æ ‡ç½‘é¡µçš„æ­£æ–‡å†…å®¹ã€‚

*   **ID**: `url_reader`
*   **è¾“å…¥å‚æ•°**:
    *   `url` (string, å¿…å¡«): ç›®æ ‡ç½‘é¡µé“¾æ¥ã€‚
    *   `maxLength` (number, é€‰å¡«): æœ€å¤§å­—ç¬¦æ•° (100-50000, é»˜è®¤ 5000)ã€‚
*   **è¾“å‡ºç¤ºä¾‹**:
    ```json
    {
      "title": "é¡µé¢æ ‡é¢˜",
      "content": "æ­£æ–‡å†…å®¹...",
      "truncated": false
    }
    ```

## æ ¸å¿ƒæ‰§è¡Œé€»è¾‘ (Execution Logic)

1.  **å˜é‡æ”¶é›† (Variable Collection)**: ç³»ç»Ÿä¼šè‡ªåŠ¨æ”¶é›†æ‰€æœ‰ä¸Šæ¸¸èŠ‚ç‚¹çš„è¾“å‡ºï¼ˆåŒ…æ‹¬ç›´æ¥ä¸Šæ¸¸ context å’Œå…¨å±€ flowContextï¼‰ï¼Œå¹¶æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¾“å‡ºå˜é‡ (`customOutputs`)ã€‚
2.  **å˜é‡å‹å¹³ (Variable Flattening)**: å°†æ”¶é›†åˆ°çš„è¾“å‡ºå±•å¼€ä¸ºä¸€ç»´çš„é”®å€¼å¯¹ï¼ˆæ”¯æŒ `nodeId.field` å’Œ `Label.field` æ ¼å¼ï¼‰ï¼Œä»¥ä¾¿åœ¨è¾“å…¥å‚æ•°ä¸­å¼•ç”¨ã€‚
3.  **å‚æ•°æ›¿æ¢ (Variable Replacement)**: åœ¨æ‰§è¡Œå‰ï¼Œ`inputs` ä¸­çš„å­—ç¬¦ä¸²å€¼ä¼šè¢«è§£æï¼Œ`{{å˜é‡}}` ä¼šè¢«æ›¿æ¢ä¸ºå®é™…å€¼ã€‚
4.  **Schema éªŒè¯ (Validation)**: æ›¿æ¢åçš„å‚æ•°ä¼šç»è¿‡ Zod Schema çš„ä¸¥æ ¼æ ¡éªŒï¼Œæ ¼å¼é”™è¯¯ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œé˜²æ­¢æ— æ•ˆè°ƒç”¨ã€‚
