# 🚀 生产环境部署检查清单

## ✅ 埋点系统生产环境准备

### 1. 调试工具移除
- [x] TrackingDebugger 组件仅在开发环境显示
- [x] Builder 页面条件渲染调试组件
- [x] 添加明确的生产环境禁用标识

### 2. 安全配置
- [x] 生产环境禁用调试日志输出
- [x] 增加高频事件采样率（10%）
- [x] 调整批量上报参数（增大批次，延长间隔）
- [x] 避免敏感信息在控制台输出

### 3. 性能优化
- [x] 生产环境批次大小：20条
- [x] 生产环境刷新间隔：10秒
- [x] 高频事件采样率：10%

### 4. 验证清单

**部署前检查：**
- [ ] 确认 `NODE_ENV=production` 环境变量设置正确
- [ ] 测试构建命令：`npm run build`
- [ ] 验证调试面板在生产构建中不出现
- [ ] 检查控制台无调试日志输出

**部署后验证：**
- [ ] 访问生产环境确认无调试面板
- [ ] 验证埋点数据正常上报到 Supabase
- [ ] 检查网络请求频率合理
- [ ] 确认用户隐私数据未泄露

## 📊 生产环境配置对比

| 配置项 | 开发环境 | 生产环境 | 说明 |
|--------|----------|----------|------|
| 调试面板 | ✅ 显示 | ❌ 隐藏 | 安全考虑 |
| 调试日志 | ✅ 输出 | ❌ 禁用 | 隐私保护 |
| 批次大小 | 10条 | 20条 | 减少请求次数 |
| 刷新间隔 | 5秒 | 10秒 | 降低服务器压力 |
| 采样率 | 5% | 10% | 平衡数据量与准确性 |

## 🔒 安全措施

1. **代码层面**：
   - 调试组件条件渲染
   - 环境变量严格检查
   - 敏感日志过滤

2. **数据层面**：
   - 高频事件采样减少数据量
   - 批量上报减少请求频率
   - JSONB 字段灵活存储各类数据

3. **监控层面**：
   - 生产环境错误日志记录
   - 埋点数据完整性校验
   - 性能指标监控

## 🎯 部署命令

```bash
# 构建生产版本
npm run build

# 预览生产构建
npm run start

# 部署到 Vercel
vercel --prod
```

## ⚠️ 注意事项

- 确保所有环境变量正确配置
- 测试完整的用户操作流程
- 监控首日的埋点数据质量
- 准备回滚方案以防意外