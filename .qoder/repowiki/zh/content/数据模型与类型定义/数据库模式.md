# æ•°æ®åº“æ¨¡å¼

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**
- [database.ts](file://src/types/database.ts)
- [flow.ts](file://src/types/flow.ts)
- [supabase.ts](file://src/lib/supabase.ts)
- [flowAPI.ts](file://src/services/flowAPI.ts)
- [health/route.ts](file://src/app/api/health/route.ts)
- [flows/page.tsx](file://src/app/flows/page.tsx)
- [FlowCard.tsx](file://src/components/flows/FlowCard.tsx)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [é¡¹ç›®ç»“æ„æ¦‚è§ˆ](#é¡¹ç›®ç»“æ„æ¦‚è§ˆ)
3. [flowsè¡¨ç»“æ„è¯¦è§£](#flowstableç»“æ„è¯¦è§£)
4. [TypeScriptç±»å‹æ˜ å°„](#typescriptç±»å‹æ˜ å°„)
5. [Jsonç±»å‹åˆ«åè®¾è®¡](#jsontypeåˆ«åè®¾è®¡)
6. [Databaseæ¥å£å±‚æ¬¡ç»“æ„](#databaseæ¥å£å±‚æ¬¡ç»“æ„)
7. [ç±»å‹å®‰å…¨çš„æ•°æ®åº“æŸ¥è¯¢](#ç±»å‹å®‰å…¨çš„æ•°æ®åº“æŸ¥è¯¢)
8. [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)
9. [æ•°æ®åº“æŸ¥è¯¢ä»£ç ç¤ºä¾‹](#æ•°æ®åº“æŸ¥è¯¢ä»£ç ç¤ºä¾‹)
10. [æœ€ä½³å®è·µä¸æ•…éšœæ’é™¤](#æœ€ä½³å®è·µä¸æ•…éšœæ’é™¤)

## ç®€ä»‹

æœ¬æ–‡æ¡£æ·±å…¥åˆ†æäº†Supabaseæ•°æ®åº“ä¸­flowsè¡¨çš„ç»“æ„è®¾è®¡åŠå…¶åœ¨TypeScriptä¸­çš„å®Œæ•´ç±»å‹æ˜ å°„ä½“ç³»ã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨å¼ºç±»å‹è®¾è®¡ï¼Œé€šè¿‡ç²¾å¿ƒæ„å»ºçš„ç±»å‹å±‚æ¬¡ç»“æ„ç¡®ä¿æ•°æ®åº“æ“ä½œçš„ç±»å‹å®‰å…¨æ€§ï¼ŒåŒæ—¶æ”¯æŒå¤æ‚çš„æµç¨‹æ•°æ®å­˜å‚¨å’Œç®¡ç†ã€‚

## é¡¹ç›®ç»“æ„æ¦‚è§ˆ

é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ¨¡å—ï¼š

```mermaid
graph TB
subgraph "å‰ç«¯å±‚"
UI[ç”¨æˆ·ç•Œé¢ç»„ä»¶]
Pages[é¡µé¢ç»„ä»¶]
end
subgraph "æœåŠ¡å±‚"
API[flowAPIæœåŠ¡]
Store[çŠ¶æ€ç®¡ç†]
end
subgraph "ç±»å‹å±‚"
Types[TypeScriptç±»å‹å®šä¹‰]
Database[æ•°æ®åº“ç±»å‹æ¥å£]
end
subgraph "å®¢æˆ·ç«¯å±‚"
Supabase[Supabaseå®¢æˆ·ç«¯]
Env[ç¯å¢ƒå˜é‡]
end
UI --> API
Pages --> API
API --> Types
API --> Supabase
Types --> Database
Supabase --> Env
```

**å›¾è¡¨æ¥æº**
- [flowAPI.ts](file://src/services/flowAPI.ts#L1-L240)
- [supabase.ts](file://src/lib/supabase.ts#L1-L18)

## flowsè¡¨ç»“æ„è¯¦è§£

### æ ¸å¿ƒå­—æ®µåˆ†æ

flowsè¡¨æ˜¯æ•´ä¸ªåº”ç”¨çš„æ ¸å¿ƒæ•°æ®è¡¨ï¼Œå­˜å‚¨ç€æ‰€æœ‰ç”¨æˆ·çš„å·¥ä½œæµä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å„å­—æ®µçš„è¯¦ç»†è¯´æ˜ï¼š

| å­—æ®µå | ç±»å‹ | çº¦æŸ | è¯­ä¹‰æè¿° |
|--------|------|------|----------|
| `id` | `string` | ä¸»é”®ï¼Œå¿…å¡« | æµç¨‹å”¯ä¸€æ ‡è¯†ç¬¦ï¼ŒUUIDæ ¼å¼ |
| `owner_id` | `string` | å¿…å¡« | æ‰€æœ‰è€…æ ‡è¯†ç¬¦ï¼Œå…³è”ç”¨æˆ·ç³»ç»Ÿ |
| `name` | `string` | å¿…å¡« | æµç¨‹åç§°ï¼Œæ˜¾ç¤ºç”¨æ ‡é¢˜ |
| `description` | `string \| null` | å¯é€‰ | æµç¨‹æè¿°ä¿¡æ¯ |
| `data` | `Json` | å¿…å¡« | å¤æ‚æµç¨‹æ•°æ®ï¼ŒJSONæ ¼å¼å­˜å‚¨ |
| `icon_kind` | `string \| null` | å¯é€‰ | å›¾æ ‡ç±»å‹ï¼šemojiã€lucideã€image |
| `icon_name` | `string \| null` | å¯é€‰ | å›¾æ ‡åç§°æˆ–å­—ç¬¦å†…å®¹ |
| `icon_url` | `string \| null` | å¯é€‰ | å›¾æ ‡å›¾ç‰‡URLåœ°å€ |
| `node_count` | `number \| null` | å¯é€‰ | èŠ‚ç‚¹æ•°é‡ç»Ÿè®¡ |
| `created_at` | `string` | è‡ªåŠ¨è®¾ç½® | è®°å½•åˆ›å»ºæ—¶é—´æˆ³ |
| `updated_at` | `string` | è‡ªåŠ¨æ›´æ–° | è®°å½•æœ€åä¿®æ”¹æ—¶é—´æˆ³ |

### å­—æ®µçº¦æŸä¸éªŒè¯

```mermaid
flowchart TD
Start([æ•°æ®æ’å…¥/æ›´æ–°]) --> ValidateId["éªŒè¯idæ ¼å¼<br/>UUIDæ ¼å¼æ£€æŸ¥"]
ValidateId --> ValidateOwner["éªŒè¯owner_id<br/>ç”¨æˆ·å­˜åœ¨æ€§æ£€æŸ¥"]
ValidateOwner --> ValidateName["éªŒè¯name<br/>éç©ºå­—ç¬¦ä¸²"]
ValidateName --> ValidateData["éªŒè¯data<br/>Jsonç±»å‹æ£€æŸ¥"]
ValidateData --> ValidateOptional["éªŒè¯å¯é€‰å­—æ®µ<br/>ç±»å‹ä¸€è‡´æ€§"]
ValidateOptional --> Success([æ“ä½œæˆåŠŸ])
ValidateId --> |æ ¼å¼é”™è¯¯| Error([éªŒè¯å¤±è´¥])
ValidateOwner --> |ä¸å­˜åœ¨| Error
ValidateName --> |ä¸ºç©º| Error
ValidateData --> |ç±»å‹é”™è¯¯| Error
ValidateOptional --> |ç±»å‹ä¸åŒ¹é…| Error
```

**å›¾è¡¨æ¥æº**
- [database.ts](file://src/types/database.ts#L13-L25)
- [flowAPI.ts](file://src/services/flowAPI.ts#L107-L142)

**ç« èŠ‚æ¥æº**
- [database.ts](file://src/types/database.ts#L13-L25)
- [flowAPI.ts](file://src/services/flowAPI.ts#L107-L142)

## TypeScriptç±»å‹æ˜ å°„

### Jsonç±»å‹åˆ«å

é¡¹ç›®å®šä¹‰äº†ä¸€ä¸ªé€’å½’çš„Jsonç±»å‹åˆ«åï¼Œç”¨äºå¤„ç†å¤æ‚çš„åµŒå¥—JSONæ•°æ®ç»“æ„ï¼š

```typescript
export type Json =
    | string
    | number
    | boolean
    | null
    | { [key: string]: Json | undefined }
    | Json[]
```

è¿™ç§è®¾è®¡å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆstringã€numberã€booleanã€nullï¼‰
- å…è®¸å¯¹è±¡ç±»å‹çš„é€’å½’å®šä¹‰
- æ”¯æŒæ•°ç»„ç±»å‹çš„é€’å½’å®šä¹‰
- åŒ…å«undefinedç±»å‹çš„å¯é€‰å±æ€§æ”¯æŒ

### FlowDataç±»å‹ç»“æ„

FlowDataæ˜¯å­˜å‚¨åœ¨flowsè¡¨dataå­—æ®µä¸­çš„å¤æ‚æ•°æ®ç»“æ„ï¼š

```mermaid
classDiagram
class FlowData {
+AppNode[] nodes
+AppEdge[] edges
+Viewport? viewport
}
class AppNode {
+string id
+NodeKind type
+AppNodeData data
+Position position
}
class AppEdge {
+string id
+string source
+string target
+string? label
+boolean? animated
+CSSProperties? style
}
class Viewport {
+number x
+number y
+number zoom
}
FlowData --> AppNode : contains
FlowData --> AppEdge : contains
FlowData --> Viewport : optional
```

**å›¾è¡¨æ¥æº**
- [flow.ts](file://src/types/flow.ts#L59-L63)
- [flow.ts](file://src/types/flow.ts#L45-L51)

**ç« èŠ‚æ¥æº**
- [database.ts](file://src/types/database.ts#L1-L8)
- [flow.ts](file://src/types/flow.ts#L59-L63)

## Jsonç±»å‹åˆ«åè®¾è®¡

### è®¾è®¡ç›®çš„

Jsonç±»å‹åˆ«åçš„è®¾è®¡æ—¨åœ¨è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š

1. **ç±»å‹å®‰å…¨æ€§**ï¼šç¡®ä¿æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®ç¬¦åˆé¢„æœŸçš„JSONç»“æ„
2. **é€’å½’æ”¯æŒ**ï¼šå…è®¸åµŒå¥—çš„å¯¹è±¡å’Œæ•°ç»„ç»“æ„
3. **çµæ´»æ€§**ï¼šæ”¯æŒå¯é€‰å±æ€§å’Œnullå€¼
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥å¼€é”€

### åº”ç”¨åœºæ™¯

åœ¨flowsè¡¨ä¸­ï¼ŒJsonç±»å‹ä¸»è¦ç”¨äºå­˜å‚¨å¤æ‚çš„æµç¨‹æ•°æ®ï¼š

```mermaid
sequenceDiagram
participant Client as å®¢æˆ·ç«¯
participant API as flowAPI
participant DB as Supabaseæ•°æ®åº“
participant Validator as è¿è¡Œæ—¶éªŒè¯å™¨
Client->>API : createFlow(name, flowData)
API->>Validator : éªŒè¯FlowDataç»“æ„
Validator->>Validator : æ£€æŸ¥nodesæ•°ç»„
Validator->>Validator : æ£€æŸ¥edgesæ•°ç»„
Validator-->>API : éªŒè¯é€šè¿‡
API->>DB : insert({data : flowData})
DB-->>API : è¿”å›è®°å½•
API-->>Client : FlowRecord
```

**å›¾è¡¨æ¥æº**
- [flowAPI.ts](file://src/services/flowAPI.ts#L37-L54)
- [flowAPI.ts](file://src/services/flowAPI.ts#L119-L120)

**ç« èŠ‚æ¥æº**
- [database.ts](file://src/types/database.ts#L1-L8)
- [flowAPI.ts](file://src/services/flowAPI.ts#L37-L54)

## Databaseæ¥å£å±‚æ¬¡ç»“æ„

### Tables.flows.Rowç±»å‹

Tables.flows.Rowç±»å‹ç²¾ç¡®æ˜ å°„æ•°æ®åº“çš„å®é™…å­—æ®µç»“æ„ï¼š

```mermaid
classDiagram
class Database {
+public : PublicSchema
}
class PublicSchema {
+Tables : Tables
}
class Tables {
+flows : FlowsTable
}
class FlowsTable {
+Row : FlowRow
+Insert : FlowInsert
+Update : FlowUpdate
}
class FlowRow {
+string id
+string owner_id
+string name
+string|null description
+Json data
+string|null icon_kind
+string|null icon_name
+string|null icon_url
+number|null node_count
+string created_at
+string updated_at
}
Database --> PublicSchema
PublicSchema --> Tables
Tables --> FlowsTable
FlowsTable --> FlowRow
```

**å›¾è¡¨æ¥æº**
- [database.ts](file://src/types/database.ts#L9-L58)

### Insertå’ŒUpdateç±»å‹çš„å·®å¼‚

Insertå’ŒUpdateç±»å‹å®ç°äº†ç²¾ç¡®çš„å­—æ®µå¯é€‰æ€§æ§åˆ¶ï¼š

| ç‰¹æ€§ | Insertç±»å‹ | Updateç±»å‹ |
|------|------------|------------|
| `id` | å¯é€‰ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰ | å¯é€‰ï¼ˆå¯æ›´æ–°ï¼‰ |
| `owner_id` | å¿…å¡« | å¯é€‰ |
| `name` | å¿…å¡« | å¯é€‰ |
| `description` | å¯é€‰ | å¯é€‰ |
| `data` | å¿…å¡« | å¯é€‰ |
| `icon_*` | å¯é€‰ | å¯é€‰ |
| `node_count` | å¯é€‰ | å¯é€‰ |
| `created_at` | è‡ªåŠ¨è®¾ç½® | ä¸å¯æ›´æ–° |
| `updated_at` | è‡ªåŠ¨æ›´æ–° | è‡ªåŠ¨æ›´æ–° |

**ç« èŠ‚æ¥æº**
- [database.ts](file://src/types/database.ts#L13-L54)

## ç±»å‹å®‰å…¨çš„æ•°æ®åº“æŸ¥è¯¢

### createClient<Database>æ³›å‹

Supabaseå®¢æˆ·ç«¯é€šè¿‡æ³›å‹å‚æ•°å¯ç”¨å®Œæ•´çš„ç±»å‹å®‰å…¨ï¼š

```typescript
// ç±»å‹å®‰å…¨çš„å®¢æˆ·ç«¯åˆ›å»º
export const supabase = createClient<Database>(url, anon);

// æŸ¥è¯¢ç»“æœè‡ªåŠ¨è·å¾—ç±»å‹æç¤º
const { data, error } = await supabase
    .from('flows')
    .select('*')
    .order('updated_at', { ascending: false });
```

### ç±»å‹æ¨æ–­æœºåˆ¶

```mermaid
flowchart LR
Database[Databaseæ¥å£] --> SupabaseClient[Supabaseå®¢æˆ·ç«¯]
SupabaseClient --> Query[æŸ¥è¯¢æ–¹æ³•]
Query --> TypedResult[ç±»å‹åŒ–ç»“æœ]
subgraph "ç±»å‹æ¨æ–­è¿‡ç¨‹"
Schema[public.Tables.flows] --> Row[Rowç±»å‹]
Row --> Select[selectæ–¹æ³•]
Select --> Result[æŸ¥è¯¢ç»“æœ]
end
TypedResult --> Result
```

**å›¾è¡¨æ¥æº**
- [supabase.ts](file://src/lib/supabase.ts#L12)
- [flowAPI.ts](file://src/services/flowAPI.ts#L14-L17)

**ç« èŠ‚æ¥æº**
- [supabase.ts](file://src/lib/supabase.ts#L12)
- [flowAPI.ts](file://src/services/flowAPI.ts#L14-L17)

## ç¯å¢ƒå˜é‡é…ç½®

### å¿…éœ€çš„ç¯å¢ƒå˜é‡

é¡¹ç›®ä¾èµ–ä»¥ä¸‹ç¯å¢ƒå˜é‡è¿›è¡Œæ•°æ®åº“è¿æ¥ï¼š

| å˜é‡å | æè¿° | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabaseé¡¹ç›®URL | `https://your-project.supabase.co` |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | åŒ¿åè®¿é—®å¯†é’¥ | `eyJhbGciOiJIUzI1NiIs...` |

### é…ç½®éªŒè¯

ç³»ç»Ÿæä¾›äº†ç¯å¢ƒå˜é‡éªŒè¯æœºåˆ¶ï¼š

```mermaid
flowchart TD
Start([åº”ç”¨å¯åŠ¨]) --> CheckEnv["æ£€æŸ¥ç¯å¢ƒå˜é‡"]
CheckEnv --> HasURL{"URLå­˜åœ¨?"}
HasURL --> |å¦| ThrowError["æŠ›å‡ºé”™è¯¯<br/>Missing Supabase environment variables"]
HasURL --> |æ˜¯| HasKey{"å¯†é’¥å­˜åœ¨?"}
HasKey --> |å¦| ThrowError
HasKey --> |æ˜¯| CreateClient["åˆ›å»ºSupabaseå®¢æˆ·ç«¯"]
CreateClient --> Success([åˆå§‹åŒ–æˆåŠŸ])
ThrowError --> End([åº”ç”¨ç»ˆæ­¢])
```

**å›¾è¡¨æ¥æº**
- [supabase.ts](file://src/lib/supabase.ts#L7-L9)

### getSupabaseClientå‡½æ•°

æœåŠ¡å™¨ç«¯ä½¿ç”¨æ¨¡å¼ï¼š

```typescript
// æœåŠ¡å™¨ç«¯å®¢æˆ·ç«¯è·å–
export function getSupabaseClient() {
    return supabase;
}

// åœ¨APIè·¯ç”±ä¸­ä½¿ç”¨
export async function GET() {
    const { data, error } = await getSupabaseClient()
        .from("flows")
        .select("id")
        .limit(1);
}
```

**ç« èŠ‚æ¥æº**
- [supabase.ts](file://src/lib/supabase.ts#L4-L17)
- [health/route.ts](file://src/app/api/health/route.ts#L4-L5)

## æ•°æ®åº“æŸ¥è¯¢ä»£ç ç¤ºä¾‹

### åŸºæœ¬CRUDæ“ä½œ

#### åˆ›å»ºæµç¨‹

```typescript
// ç±»å‹å®‰å…¨çš„åˆ›å»ºæ“ä½œ
const newFlow = await flowAPI.createFlow(
    "æ•°æ®åˆ†ææµç¨‹",           // name: string
    { nodes: [], edges: [] }, // flowData: FlowData
    "user123",               // ownerId: string
    "å¤„ç†CSVæ•°æ®é›†"          // description?: string
);
```

#### æŸ¥è¯¢æµç¨‹åˆ—è¡¨

```typescript
// ç±»å‹å®‰å…¨çš„æŸ¥è¯¢æ“ä½œ
const flows = await flowAPI.listFlows("user123");

// æŸ¥è¯¢ç»“æœè‡ªåŠ¨è·å¾—ç±»å‹æç¤º
flows.forEach(flow => {
    console.log(flow.name);           // stringç±»å‹
    console.log(flow.node_count);     // number | nullç±»å‹
    console.log(flow.data.nodes);     // AppNode[]ç±»å‹
});
```

#### æ›´æ–°æµç¨‹

```typescript
// ç±»å‹å®‰å…¨çš„éƒ¨åˆ†æ›´æ–°
const updatedFlow = await flowAPI.updateFlow(flowId, {
    name: "æ›´æ–°åçš„æµç¨‹åç§°",
    description: "æ–°çš„æè¿°ä¿¡æ¯",
    data: { nodes: [...], edges: [...] },
    icon_kind: "emoji",
    icon_name: "ğŸš€"
});
```

### é«˜çº§æŸ¥è¯¢æ¨¡å¼

#### æ¡ä»¶æŸ¥è¯¢

```typescript
// ä½¿ç”¨æ¡ä»¶æŸ¥è¯¢
const query = supabase
    .from('flows')
    .select('*')
    .eq('owner_id', userId)
    .ilike('name', `%${searchTerm}%`)
    .order('updated_at', { ascending: false });

const { data, error } = await query;
```

#### èšåˆæŸ¥è¯¢

```typescript
// ç»Ÿè®¡ç”¨æˆ·æµç¨‹æ•°é‡
const { count, error } = await supabase
    .from('flows')
    .select('*', { count: 'exact' })
    .eq('owner_id', userId);
```

**ç« èŠ‚æ¥æº**
- [flowAPI.ts](file://src/services/flowAPI.ts#L107-L239)
- [flows/page.tsx](file://src/app/flows/page.tsx#L23-L49)

## æœ€ä½³å®è·µä¸æ•…éšœæ’é™¤

### ç±»å‹å®‰å…¨æœ€ä½³å®è·µ

1. **å§‹ç»ˆä½¿ç”¨æ³›å‹å‚æ•°**ï¼šåˆ›å»ºå®¢æˆ·ç«¯æ—¶æŒ‡å®šDatabaseç±»å‹
2. **åˆ©ç”¨ç±»å‹æ¨æ–­**ï¼šè®©TypeScriptè‡ªåŠ¨æ¨æ–­æŸ¥è¯¢ç»“æœç±»å‹
3. **è¿è¡Œæ—¶éªŒè¯**ï¼šå¯¹å¤æ‚æ•°æ®ç»“æ„è¿›è¡Œè¿è¡Œæ—¶éªŒè¯
4. **é”™è¯¯å¤„ç†**ï¼šå¦¥å–„å¤„ç†æ•°æ®åº“æ“ä½œä¸­çš„é”™è¯¯

### å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

#### ç±»å‹ä¸åŒ¹é…é—®é¢˜

```typescript
// é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…
const result = await supabase.from('flows').select('invalid_field');

// æ­£ç¡®ï¼šä½¿ç”¨æ­£ç¡®çš„å­—æ®µå
const result = await supabase.from('flows').select('name, description');
```

#### Jsonç±»å‹è½¬æ¢é—®é¢˜

```typescript
// é”™è¯¯ï¼šç±»å‹è½¬æ¢ä¸å½“
const data = { nodes: [], edges: [] };
const result = await supabase.from('flows').insert({ data });

// æ­£ç¡®ï¼šä½¿ç”¨ç±»å‹æ–­è¨€
const result = await supabase.from('flows').insert({
    data: data as unknown as Record<string, unknown>
});
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **é€‰æ‹©æ€§æŸ¥è¯¢**ï¼šåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
2. **ç´¢å¼•ä¼˜åŒ–**ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç«‹ç´¢å¼•
3. **æ‰¹é‡æ“ä½œ**ï¼šä½¿ç”¨æ‰¹é‡æ’å…¥å’Œæ›´æ–°
4. **ç¼“å­˜ç­–ç•¥**ï¼šåˆç†ä½¿ç”¨å®¢æˆ·ç«¯ç¼“å­˜

### ç›‘æ§ä¸è°ƒè¯•

```typescript
// å¥åº·æ£€æŸ¥ç«¯ç‚¹
export async function GET() {
    const { data, error } = await supabase.from("flows").select("id").limit(1);
    
    return NextResponse.json({
        connected: error === null,
        table_ok: Array.isArray(data),
        error: error?.message
    });
}
```

**ç« èŠ‚æ¥æº**
- [health/route.ts](file://src/app/api/health/route.ts#L29-L42)
- [flowAPI.ts](file://src/services/flowAPI.ts#L37-L54)

## ç»“è®º

è¯¥Supabaseæ•°æ®åº“æ¨¡å¼é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„TypeScriptç±»å‹ç³»ç»Ÿï¼Œå®ç°äº†å®Œæ•´çš„ç±»å‹å®‰å…¨ä¿éšœã€‚flowsè¡¨ä½œä¸ºæ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œæ”¯æŒå¤æ‚çš„å·¥ä½œæµæ•°æ®å­˜å‚¨ï¼ŒåŒæ—¶ä¿æŒäº†è‰¯å¥½çš„æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚é€šè¿‡åˆç†çš„ç±»å‹æ˜ å°„å’Œè¿è¡Œæ—¶éªŒè¯ï¼Œç³»ç»Ÿèƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶æ•è·å¤§éƒ¨åˆ†ç±»å‹é”™è¯¯ï¼Œå¤§å¤§é™ä½äº†è¿è¡Œæ—¶é”™è¯¯çš„é£é™©ã€‚

è¿™ç§è®¾è®¡æ¨¡å¼ä¸ºç°ä»£Webåº”ç”¨æä¾›äº†å¯å‚è€ƒçš„æœ€ä½³å®è·µï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚æ•°æ®ç»“æ„å’Œä¿è¯ç±»å‹å®‰å…¨æ–¹é¢ã€‚å¼€å‘è€…å¯ä»¥åŸºäºæ­¤æ¨¡å¼æ„å»ºæ›´åŠ å¥å£®å’Œå¯ç»´æŠ¤çš„åº”ç”¨ç¨‹åºã€‚