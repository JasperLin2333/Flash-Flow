<p align="center">
  <img src="src/app/Logo.png" alt="Flash Flow Logo" width="180" height="180">
</p>

<h1 align="center">⚡ Flash Flow</h1>

<p align="center">
  <strong>说出来，就做出来 —— AI 工作流，30秒搞定</strong>
</p>

<p align="center">
  <a href="https://flash-flow-gray.vercel.app/">
    <img src="https://img.shields.io/badge/🚀_Live_Demo-Flash_Flow-6366f1?style=for-the-badge&labelColor=1e1b4b" alt="Live Demo">
  </a>
  <a href="https://github.com/JasperLin2333/Flash-Flow">
    <img src="https://img.shields.io/badge/GitHub-Source_Code-181717?style=for-the-badge&logo=github&logoColor=white" alt="GitHub">
  </a>
  <a href="#-快速开始">
    <img src="https://img.shields.io/badge/📖_Docs-Get_Started-22c55e?style=for-the-badge&labelColor=14532d" alt="Documentation">
  </a>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/Next.js-16-black?style=flat-square&logo=next.js&logoColor=white" alt="Next.js">
  <img src="https://img.shields.io/badge/React-19-61DAFB?style=flat-square&logo=react&logoColor=black" alt="React">
  <img src="https://img.shields.io/badge/TypeScript-5-3178C6?style=flat-square&logo=typescript&logoColor=white" alt="TypeScript">
  <img src="https://img.shields.io/badge/Supabase-Backend-3FCF8E?style=flat-square&logo=supabase&logoColor=white" alt="Supabase">
  <img src="https://img.shields.io/badge/License-MIT-yellow?style=flat-square" alt="MIT License">
</p>

<br>

<p align="center">
  <img src="image-3.png" alt="Flash Flow Workflow Editor" width="90%" style="border-radius: 12px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);">
</p>

<br>

---

## 🌟 Overview

> **一句话描述你的需求，AI 帮你生成完整工作流。**

Flash Flow 是一款革命性的 AI 工作流生成平台。无需拖拽、无需配置、无需编程 —— 只需 **自然语言描述**，即可在 **30秒内** 完成从想法到落地的全过程。

```
"帮我做一个文档问答工具，用户上传PDF后可以提问"
```

<p align="center">⬇️ <strong>AI 自动生成完整工作流</strong> ⬇️</p>

```
📥 输入节点(文件上传) → 📖 RAG智能检索 → 🧠 LLM深度理解 → 📤 精准输出
```

<br>

## ✨ 核心特性

<table>
<tr>
<td align="center" width="25%">
<br>
<img src="https://img.icons8.com/fluency/96/microphone.png" width="64" height="64" alt="Voice">
<br><br>
<h3>🗣️ 口喷工作流</h3>
<p>用嘴说，用 AI 造<br>一句话生成完整工作流</p>
</td>
<td align="center" width="25%">
<br>
<img src="https://img.icons8.com/fluency/96/accuracy.png" width="64" height="64" alt="Accuracy">
<br><br>
<h3>🎯 精准生成</h3>
<p>节点自动连接<br>参数智能填充</p>
</td>
<td align="center" width="25%">
<br>
<img src="https://img.icons8.com/fluency/96/time-machine.png" width="64" height="64" alt="Speed">
<br><br>
<h3>⚡ 极速创建</h3>
<p>描述 → 生成 → 预览 → 发布<br>全程仅需 30 秒</p>
</td>
<td align="center" width="25%">
<br>
<img src="https://img.icons8.com/fluency/96/visual-game-boy.png" width="64" height="64" alt="Visual">
<br><br>
<h3>🧩 可视化编排</h3>
<p>拖拽连线<br>所见即所得</p>
</td>
</tr>
</table>

<br>

---

## � 最新更新 (v0.2)

| 新功能 | 描述 |
|:---:|:---|
| 🔐 **邮箱 OTP 认证** | 支持邮箱验证码登录/注册，更安全的身份认证 |
| 📊 **用户配额管理** | LLM 调用次数、工作流生成次数、应用使用次数追踪 |
| 🤖 **多模型动态路由** | 智能选择 SiliconFlow / DashScope / OpenAI 等服务商 |
| 💬 **对话记忆** | LLM 节点支持 1-20 轮上下文记忆 |
| 📝 **Markdown 渲染** | 丰富的输出格式支持（表格、代码高亮、任务列表等） |
| 🌊 **流式响应** | 打字机效果实时输出，支持分段/选择模式 |
| 🐍 **代码执行器** | 新增 E2B 沙箱 Python 代码执行工具 |
| 🏗️ **模块化执行器** | 重构节点执行架构，支持独立调试和测试 |

<br>

---

## �🎬 产品展示

<table>
<tr>
<td align="center" width="50%">
<img src="image.png" alt="首页" style="border-radius: 8px;">
<br><em>首页 - 简洁现代的界面设计</em>
</td>
<td align="center" width="50%">
<img src="image-2.png" alt="Flow Box" style="border-radius: 8px;">
<br><em>Flow Box - 工作流管理中心</em>
</td>
</tr>
<tr>
<td align="center" width="50%">
<img src="image-3.png" alt="工作流编排" style="border-radius: 8px;">
<br><em>工作流编辑器 - 强大的可视化画布</em>
</td>
<td align="center" width="50%">
<img src="image-4.png" alt="预览页面" style="border-radius: 8px;">
<br><em>预览 & APP - 即时体验你的创作</em>
</td>
</tr>
</table>

<br>

---

## 🔧 节点能力

Flash Flow 提供 6 种强大的节点类型，覆盖各类工作流场景：

### 📥 输入节点

支持三种输入模式，灵活组合：

| 模式 | 说明 | 输出变量 |
|:---:|:---|:---|
| **📝 文本** | 用户自由输入文本内容 | `{{节点名.user_input}}` |
| **📎 文件** | 支持 PDF / Word / 图片等多格式 | `{{节点名.files[0].url}}` |
| **📋 表单** | 下拉单选 / 多选 / 文本框组合 | `{{节点名.formData.字段名}}` |

### 🧠 LLM 节点

多模型支持 + 智能对话记忆：

| 能力 | 说明 |
|:---:|:---|
| **多模型切换** | Qwen / GPT / Gemini / Doubao 一键切换 |
| **动态路由** | 自动选择最佳服务商 (SiliconFlow / DashScope / OpenAI) |
| **变量注入** | Prompt 中 `{{变量}}` 自动替换 |
| **对话记忆** | 可配置 1-20 轮记忆，支持多轮上下文 |
| **流式输出** | 打字机效果 + Markdown 实时渲染 |

### 📖 RAG 节点

双模式智能检索，满足不同场景：

| 模式 | 场景 | 配置方式 |
|:---:|:---|:---|
| **🏛️ 静态** | 固定知识库问答 | Builder 预上传文档 |
| **🔄 动态** | 用户上传即查询 | 引用 `{{输入节点.files}}` |

> 💡 动态模式采用 Gemini File Search API，实现**秒级响应**

### 🔧 工具节点

**6 种**即插即用的实用工具：

| 工具 | 功能 | 参数示例 |
|:---:|:---|:---|
| 🌐 **网页搜索** | Tavily 实时搜索引擎 | `query: {{user_input}}` |
| 🧮 **计算器** | 复杂数学表达式计算 | `expression: "2+2*3"` |
| 📅 **日期时间** | 获取 / 格式化 / 日期计算 | `format: "YYYY-MM-DD"` |
| 📰 **网页读取** | 智能提取网页正文 | `url: "https://..."` |
| 🐍 **代码执行** | E2B 沙箱 Python 执行 | `code: "print('Hello!')"` |
| ⛅ **天气查询** | 和风天气实时数据 | `city: "北京"` |

> 🆕 **代码执行器** 可在安全沙箱中运行 Python 代码，支持文件输入输出

### 🔀 分支节点

安全表达式引擎，内置白名单防护：

```javascript
// 字符串判断
用户输入.user_input.includes('咨询')

// 数值比较  
计算结果.result > 60

// 等值判断
状态检查.type === 'VIP'
```

### 📤 输出节点

四种输出模式，灵活适配各类场景：

| 模式 | 场景 | 配置示例 |
|:---:|:---|:---|
| `direct` | 单一来源直接输出 | `{{LLM.response}}` |
| `select` | 分支择优选择 | 取第一个非空结果 |
| `merge` | 多源智能合并 | 摘要 + 详情组合 |
| `template` | 自定义模板输出 | `## 问题\n{{user_input}}` |

> 📝 输出支持完整 **Markdown 渲染**（表格、代码块、任务列表等）

<br>

---

## 🔗 变量引用系统

### 简洁直观的引用语法

| 格式 | 示例 | 说明 |
|:---:|:---|:---|
| **字段名** | `{{user_input}}` | 自动匹配上游节点 |
| **节点.字段** | `{{用户输入.user_input}}` | 精确指定节点（推荐） |
| **嵌套访问** | `{{输入.formData.stock}}` | 访问表单字段 |
| **数组索引** | `{{输入.files[0].url}}` | 访问文件属性 |

> 🖱️ **点击即插入** —— 参数面板显示所有可用变量，一键复制，告别手写

<br>

---

## 🚀 典型应用场景

| 场景 | 一句话需求 | 生成耗时 |
|:---:|:---|:---:|
| 📊 **智能报告** | "输入主题，搜索资料生成分析报告" | ~30s |
| 📝 **文档问答** | "上传文档，基于内容智能问答" | ~20s |
| 🔀 **智能分流** | "根据用户意图路由到不同处理" | ~40s |
| 📰 **资讯摘要** | "输入URL，提取正文并生成摘要" | ~25s |
| 🐍 **数据处理** | "上传CSV，用Python分析生成图表" | ~35s |

<br>

---

## 🎯 复杂工作流示例

> **看看 Flash Flow 如何一句话生成复杂的金融危机应对工作流**

<details>
<summary><b>📝 查看生成提示词</b></summary>

```
请构建一个非常复杂的金融危机应对工作流。
用户输入股票代码并上传财报，同时填写当前持仓金额。
工作流同时进行联网搜索新闻和 RAG 分析上传的财报。
用一个 LLM 汇总信息并输出 JSON 格式的风险评分（0-100）。
使用 Branch 节点判断：如果分 >80，检索静态知识库中的危机 SOP 并生成公关稿；
如果分 <=80，调用计算器工具计算加仓 20% 后的金额，并生成交易日报。
最后输出一份包含时间戳、风险评估和最终策略（公关稿或交易建议）的综合报告，并附带原始财报文件。
```

</details>

<p align="center">
  <img src="image-5.png" alt="复杂工作流示例" width="90%" style="border-radius: 8px;">
  <br><em>AI 自动生成的金融危机应对工作流 - 包含并行执行、分支判断、多节点协作</em>
</p>

<br>

---

## 🛠️ 技术架构

<table>
<tr>
<td align="center" width="25%">
<h3>🎨 前端</h3>
<p>
<img src="https://img.shields.io/badge/Next.js-16-black?style=flat-square&logo=next.js">
<br>
<img src="https://img.shields.io/badge/React-19-61DAFB?style=flat-square&logo=react&logoColor=black">
<br>
<img src="https://img.shields.io/badge/TypeScript-5-3178C6?style=flat-square&logo=typescript&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Zustand-5-764ABC?style=flat-square">
<br>
<img src="https://img.shields.io/badge/XYFlow-12-FF6B6B?style=flat-square">
</p>
</td>
<td align="center" width="25%">
<h3>🎭 UI 组件</h3>
<p>
<img src="https://img.shields.io/badge/Radix_UI-Latest-161618?style=flat-square&logo=radix-ui">
<br>
<img src="https://img.shields.io/badge/Tailwind-4-38B2AC?style=flat-square&logo=tailwind-css&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Framer_Motion-12-0055FF?style=flat-square&logo=framer&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Lucide_Icons-Latest-F56565?style=flat-square">
</p>
</td>
<td align="center" width="25%">
<h3>⚙️ 后端</h3>
<p>
<img src="https://img.shields.io/badge/Supabase-PostgreSQL-3FCF8E?style=flat-square&logo=supabase&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Supabase-Auth-3FCF8E?style=flat-square&logo=supabase&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Supabase-Storage-3FCF8E?style=flat-square&logo=supabase&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Zod-验证-3E67B1?style=flat-square">
</p>
</td>
<td align="center" width="25%">
<h3>🤖 AI 引擎</h3>
<p>
<img src="https://img.shields.io/badge/OpenAI-GPT-412991?style=flat-square&logo=openai&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Google-Gemini-4285F4?style=flat-square&logo=google&logoColor=white">
<br>
<img src="https://img.shields.io/badge/Alibaba-Qwen-FF6A00?style=flat-square">
<br>
<img src="https://img.shields.io/badge/ByteDance-Doubao-00D1C1?style=flat-square">
</p>
</td>
</tr>
</table>

### 🏗️ 核心架构

```
┌─────────────────────────────────────────────────────────────┐
│                     Flash Flow Architecture                  │
├─────────────────────────────────────────────────────────────┤
│  Frontend (Next.js 16 + React 19)                           │
│  ├── XYFlow Canvas (可视化编排)                              │
│  ├── Zustand Store (状态管理)                                │
│  └── Streaming UI (流式响应)                                 │
├─────────────────────────────────────────────────────────────┤
│  Modular Executor Layer (模块化执行层)                       │
│  ├── InputNodeExecutor   │  LLMNodeExecutor                 │
│  ├── RAGNodeExecutor     │  ToolNodeExecutor                │
│  ├── BranchNodeExecutor  │  OutputNodeExecutor              │
│  └── ContextUtils (变量解析)                                 │
├─────────────────────────────────────────────────────────────┤
│  Services Layer (服务层)                                     │
│  ├── AuthService (OTP 认证)  │  QuotaService (配额管理)      │
│  ├── LLMMemoryService (记忆) │  FileUploadService           │
│  └── GeminiFileSearchAPI (RAG)                              │
├─────────────────────────────────────────────────────────────┤
│  Backend (Supabase)                                         │
│  ├── PostgreSQL (数据存储)  │  Row Level Security           │
│  ├── Auth (用户认证)        │  Storage (文件存储)            │
│  └── Realtime (实时同步)                                     │
└─────────────────────────────────────────────────────────────┘
```

<br>

---

## 📦 快速开始

### 1️⃣ 克隆项目

```bash
git clone https://github.com/JasperLin2333/Flash-Flow.git
cd flash-flow
```

### 2️⃣ 安装依赖

```bash
npm install
```

### 3️⃣ 环境配置

创建 `.env.local` 文件并配置以下环境变量：

```env
# Supabase 配置
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key

# AI 模型 API Keys
OPENAI_API_KEY=your_openai_api_key
GOOGLE_GENAI_API_KEY=your_google_api_key

# 可选：阿里云 DashScope
DASHSCOPE_API_KEY=your_dashscope_api_key

# 可选：硅基流动 SiliconFlow
SILICONFLOW_API_KEY=your_siliconflow_api_key

# 工具 API Keys
TAVILY_API_KEY=your_tavily_api_key
QWEATHER_API_KEY=your_qweather_api_key  # 可选，用于天气功能
E2B_API_KEY=your_e2b_api_key            # 可选，用于代码执行
```

### 4️⃣ 启动开发服务器

```bash
npm run dev
```

🎉 访问 **[http://localhost:3000](http://localhost:3000)** 开始体验！

<br>

---

## 🔒 安全保障

Flash Flow 内置多层安全机制，保障数据和执行安全：

| 机制 | 说明 |
|:---:|:---|
| ✅ **循环检测** | 执行前 DFS 校验，防止工作流无限循环 |
| ✅ **并发控制** | 乐观锁机制防止配额竞态条件 |
| ✅ **参数验证** | Zod Schema 强类型校验，拒绝非法输入 |
| ✅ **表达式白名单** | Branch 节点内置安全表达式引擎，防代码注入 |
| ✅ **数据隔离** | Supabase Row Level Security 多租户隔离 |
| ✅ **沙箱执行** | 代码执行器在 E2B 隔离沙箱中运行 |

<br>

---

## 📄 开源协议

本项目基于 [MIT License](LICENSE) 开源 —— 自由使用，欢迎贡献！

<br>

---

<p align="center">
  <strong>⚡ Flash Flow —— 让 AI 工作流回归简单</strong>
</p>

<p align="center">
  <a href="https://flash-flow-gray.vercel.app/">
    <img src="https://img.shields.io/badge/🚀_立即体验-Flash_Flow-6366f1?style=for-the-badge&labelColor=1e1b4b" alt="Try Flash Flow">
  </a>
</p>

<p align="center">
  <sub>Made with ❤️ by <a href="https://github.com/JasperLin2333">Jasper Lin</a> · Star ⭐ if you like it!</sub>
</p>